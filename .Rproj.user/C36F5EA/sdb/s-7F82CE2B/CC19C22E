{
    "contents" : "library(shiny)\nlibrary(ggplot2)\n\nshinyServer(\n  function(input, output) {\n    output$powerPlot <- renderPlot({\n      \n      x <- seq(27, 36, by = 0.01)\n      \n      y <- dt((x-input$mu0)/(input$sigma/sqrt(input$n)),input$n-1)\n      \n      df <- data.frame(x)\n      df <- cbind(df, y)\n      df$sampleMean <- \"distribution under null hypothesis\"\n      \n      y <- dt((x-input$mua)/(input$sigma/sqrt(input$n)),input$n-1)\n      \n      dfa <- data.frame(x)\n      dfa <- cbind(dfa, y)\n      dfa$sampleMean <- \"distribution under alternative hypothesis\"\n      \n      df <- rbind(df, dfa)\n      \n      xitc <- input$mu0 + qt(1 - input$alpha,df = input$n) * input$sigma/sqrt(input$n)\n      power <- power.t.test(input$n,input$mua-input$mu0,sd=input$sigma,type=\"one.sample\",alt=\"one.sided\",sig.level = input$alpha)$power\n      \n      output$xitc <- renderPrint({xitc})\n      output$power <- renderPrint({power})\n      \n      ggplot(df, aes(x=x, y=y, colour=sampleMean), xlab=\"mean\", ylab=\"probability\") + \n        geom_line() + \n        geom_vline(xintercept = xitc, size = 1) + \n        scale_colour_manual(name=\"\",values=c(\"blue\", \"red\")) + \n        theme(legend.position=\"top\", legend.direction=\"horizontal\") +\n        ggtitle(\"Sample Mean Distribution\") +\n        xlab(\"mean\") +\n        ylab(\"probability\") \n      \n    })\n  }\n)\n",
    "created" : 1438845275518.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "962808353",
    "id" : "CC19C22E",
    "lastKnownWriteTime" : 1438848273,
    "path" : "~/DataSciTraining/Repos/DataProductsShiny/server.R",
    "project_path" : "server.R",
    "properties" : {
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "type" : "r_source"
}